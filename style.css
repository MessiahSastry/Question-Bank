/* Global, Splash, Login, Dashboard Headers, Cards, Settings - (Existing styles from before) */
html, body {
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: #f4f8fc;
  min-height: 100vh;
  min-width: 100vw;
  overflow-x: hidden;
}

/* Splash Screen Styles */
#splash {
  position: fixed;
  z-index: 9999;
  left: 0; top: 0; right: 0; bottom: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  background: #eaf1fa;
  transition: opacity 0.5s ease-out;
  opacity: 1;
}
#splash.hidden {
  opacity: 0;
  pointer-events: none;
}
.splash-logo {
  width: 120px;
  height: auto;
  margin-bottom: 20px;
}
.splash-title {
  font-size: 2.1em;
  font-weight: bold;
  margin-bottom: 6px;
  color: #0f3d6b;
}
.splash-subtitle {
  font-size: 1.15em;
  color: #1467b7;
}

/* Login Page Specific Styles */
#login-section { /* Changed from #login-root to match ID used in JS */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 30px; /* Added padding for smaller screens */
  box-sizing: border-box;
}
.login-box {
  width: 100%; /* Full width on small screens */
  max-width: 380px; /* Increased max-width slightly */
  margin: 0 auto;
  background: #fff;
  border-radius: 18px;
  box-shadow: 0 6px 24px #0f3d6b1f; /* Softer shadow */
  padding: 0; /* Padding handled by login-header and content area */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  overflow: hidden; /* Ensures header radius is respected */
}
.login-header {
  width: 100vw; background: #0f3d6b; color: #fff;
  border-bottom-left-radius: 28px; border-bottom-right-radius: 28px; /* Softer curve */
  min-height: 90px; /* Adjusted */
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  position: relative; box-shadow: 0 3px 15px #0f3d6b33; /* Enhanced shadow */
  padding: 15px 10px 18px 10px; /* Adjusted padding */
  box-sizing: border-box;
}
.login-title {
  font-size: 1.6em; /* Adjusted */
  font-weight: bold;
  color: #fff;
  letter-spacing: 1.5px; /* Adjusted */
  margin-bottom: 5px; /* Adjusted */
  text-transform: uppercase;
}
.login-subtitle {
  font-size: 1em; /* Adjusted */
  color: #c6e0ff;
  font-weight: 500;
  margin-bottom: 0;
  letter-spacing: 1px;
}
.login-box form, /* If inputs are wrapped in a form */
.login-box > input, /* Direct children if no form */
.login-box > .forgot-row,
.login-box > button {
  margin-left: 25px; /* Padding for form elements */
  margin-right: 25px;
}
.login-box > input:first-of-type { /* Spacing after header */
    margin-top: 25px;
}
.login-box input[type="email"],
.login-box input[type="password"] {
  width: calc(95% - 24px); /* Adjust for padding within input if any */
  padding: 8px; /* Increased padding */
  font-size: 1.05em; /* Adjusted */
  margin-bottom: 12px; /* Increased spacing */
  border-radius: 6px;
  border: 1.3px solid #bcd6ef;
  background: #f7fafd;
  transition: border-color .2s;
  box-sizing: border-box;
}
.login-box input:focus { outline: none; border-color: #0f3d6b; }
.btn-email, .btn-register, .btn-google {
  font-size: 1em;
  border: none;
  padding: 8px 0;
  border-radius: 8px;
  margin-top: 8px; /* Adjusted */
  font-weight: bold;
  color: #fff;
  cursor: pointer;
  margin-bottom: 8px; /* Adjusted */
  transition: background 0.17s, transform 0.1s;
  width: calc(95% - 24px); /* Ensure full width within padded area */
}
.btn-email { background: #1762a7; }
.btn-register { background: #1db954; }
.btn-google { background: #0f3d6b; } /* Consistent with login header */
.btn-email:hover, .btn-register:hover, .btn-google:hover {
    transform: translateY(-1px);
    opacity: 0.9;
}
.btn-google i { margin-right: 8px; }
.forgot-row {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 15px; /* Increased space before buttons */
  margin-top: -5px; /* Pull up slightly */
}
.forgot-row button {
  background: none; border: none; color: #0f3d6b;
  font-size: .9em; cursor: pointer; text-decoration: underline;
}
.login-box > button:last-child { /* Last button in the box */
    margin-bottom: 25px;
}

/* General School Title and Subtitle (used in headers) */
.school-title { /* This is for dashboard header */
  font-size: 1.8em; /* Adjusted for dashboard */
  font-weight: bold;
  color: #fff; /* Dashboard header is dark */
  letter-spacing: 2px;
  margin-bottom: 2px;
  text-align: center;
  text-transform: uppercase;
}
.subtitle-row {
  width: 100%; display: flex; align-items: center;
  justify-content: center; position: relative;
  margin-top: 2px; margin-bottom: 2px;
}
.subtitle { /* This is for dashboard header */
  flex: 1 1 auto; font-size: 1.05em; color: #e0eaff; /* Lighter for contrast */
  font-weight: 500; text-align: center; letter-spacing: 1px;
  padding-left: 40px; /* Space for potential left icon/button if settings moves */
  padding-right: 40px; /* Space for settings button */
}

/* DASHBOARD HEADER */
.dashboard-header {
  width: 100vw; background: #0f3d6b; color: #fff;
  border-bottom-left-radius: 28px; border-bottom-right-radius: 28px; /* Softer curve */
  min-height: 90px; /* Adjusted */
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  position: relative; box-shadow: 0 3px 15px #0f3d6b33; /* Enhanced shadow */
  padding: 15px 10px 18px 10px; /* Adjusted padding */
  box-sizing: border-box;
}
.settings-btn {
  background: rgba(255,255,255,0.1); border: none;
  border-radius: 50%; padding: 9px 11px; /* Adjusted */
  color: #fff; font-size: 1.2em; /* Adjusted */
  cursor: pointer;
  position: absolute; /* Positioned within header */
  top: 50%; right: 15px; /* Adjusted position */
  transform: translateY(-50%);
  box-shadow: 0 1px 5px rgba(0,0,0,0.1);
  transition: background 0.14s;
}
.settings-btn:hover { background: rgba(255,255,255,0.22); }

/* DASHBOARD MAIN AREA */
.dashboard-main {
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box;
  min-height: 70vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
}
.welcome-message {
  font-size: 1.3em; font-weight: 500; color: #185496;
  margin-bottom: 20px; margin-top: 5px; /* Adjusted */
  text-align: left;
}
.dashboard-cards {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 22px; /* Adjust space between cards */
  min-height: 60vh; /* Vertically center in available space */
}
.dashboard-card {
  background: #fff;
  color: #0f3d6b;
  border: none;
  border-radius: 12px;
  box-shadow: 0 4px 12px #0f3d6b1a;
  font-size: 1.22em; /* Increase/decrease as needed */
  font-weight: 600;
  padding: 12px 20px;          /* Reduced top/bottom for less height */
  text-align: center;
  cursor: pointer;
  transition: box-shadow 0.2s, transform 0.2s, background-color 0.2s;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 60px;            /* Less minimum height */
  width: 100%;                 /* Full width of container */
  max-width: 420px;            /* Prevents cards being too wide on large screens */
  margin: 0 auto;              /* Center horizontally */
}
.dashboard-card:hover, .dashboard-card:focus {
  box-shadow: 0 6px 20px #0f3d6b2b;
  background-color: #f0f8ff;
  outline: none;
  transform: translateY(-2px);
}
.dashboard-card.locked {
  background: #e9ecef; color: #adb5bd; cursor: not-allowed;
  opacity: 0.8; border: 1px dashed #ced4da;
}
.dashboard-card .card-lock { /* If you add a lock icon */
  position: absolute; top: 10px; right: 10px;
  color: #adb5bd; font-size: 1em;
}

/* REVIEW CONTAINER (used for AI setup form, QB filters, etc.) */
.review-container {
  max-width: 700px; /* Wider for forms */
  margin: 25px auto; /* Centered with top/bottom margin */
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 4px 18px #0f3d6b1b;
  padding: 20px 25px 30px 25px; /* Adjusted padding */
  box-sizing: border-box;
}
.review-container h2 {
    text-align: center;
    color: #0f3d6b;
    margin-top: 5px;
    margin-bottom: 25px;
}
/* Form elements within review-container */
.review-container form { display: flex; flex-direction: column; gap: 15px; }
.review-container label {
  font-weight: 600; margin-bottom: 3px; /* Reduced margin */
  color: #185496; font-size: 0.95em;
}
.review-container input[type="text"],
.review-container input[type="number"], /* If you add number inputs */
.review-container textarea,
.review-container select { /* Style standard select if not using custom */
  width: 100%; padding: 10px 12px;
  border-radius: 6px; border: 1.3px solid #bcd6ef;
  font-size: 1em; background: #f7fafd; box-sizing: border-box;
  transition: border-color 0.18s, box-shadow 0.17s;
}
.review-container textarea { min-height: 60px; resize: vertical; }
.review-container input:focus,
.review-container textarea:focus,
.review-container select:focus {
  border-color: #1762a7; box-shadow: 0 1px 8px #0f3d6b18; outline: none;
}
.review-container button[type="submit"],
.review-container .btn { /* General button style within review container */
  background: linear-gradient(90deg, #1762a7, #0f3d6b);
  color: #fff; border: none; border-radius: 8px;
  font-size: 1.05em; font-weight: bold; cursor: pointer;
  padding: 12px 0; margin-top: 10px; /* Add some top margin */
  width: 100%; box-shadow: 0 2px 8px #0f3d6b18;
  transition: background 0.2s, transform 0.15s;
}
.review-container button[type="submit"]:hover,
.review-container .btn:hover {
  background: linear-gradient(90deg, #0f3d6b, #1762a7);
  transform: translateY(-2px);
}


/* SETTINGS POPUP */
.settings-popup {
  position: fixed; left: 0; top: 0; right: 0; bottom: 0;
  background: rgba(22,40,67,0.2); /* Slightly darker overlay */
  z-index: 1001; display: none; /* Initially hidden, shown by JS */
  align-items: center; justify-content: center; padding: 15px;
}
.settings-popup .popup-content {
  min-width: 300px; max-width: 450px; width: 90%;
  background: #fff; border-radius: 12px; /* Softer radius */
  box-shadow: 0 8px 32px #0f3d6b33;
  padding: 25px 30px; text-align: center; position: relative;
  animation: popupfade 0.25s ease-out;
}
@keyframes popupfade {
  from { opacity: 0; transform: scale(0.95) translateY(10px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}
.settings-popup h2 { margin-top: 0; margin-bottom: 20px; color: #0f3d6b; }
.settings-popup label { display: block; margin-bottom: 5px; font-weight: 600; color: #185496; font-size: 0.9em; text-align: left;}
.settings-popup input[type="text"] {
  padding: 10px 14px; font-size: 1em; border-radius: 7px;
  border: 1.2px solid #bcd6ef; margin-bottom: 20px; /* Increased margin */
  width: 100%; background: #f7fafd; box-sizing: border-box;
}
.settings-popup button {
  background: #1762a7; color: #fff; border: none;
  border-radius: 8px; padding: 11px 0; font-size: 1em;
  font-weight: bold; cursor: pointer; width: 100%; /* Full width */
  margin: 8px 0; /* Consistent margin */
  display: block; transition: background 0.17s;
}
.settings-popup button.logout-btn { background: #d9534f; } /* Bootstrap danger-like */
.settings-popup button.close-btn { background: #6c757d; } /* Bootstrap secondary-like */
.settings-popup button:hover { opacity: 0.85; }
hr { border: 0; height: 1px; background: #d4e3f9; margin: 20px 0; }


/* QUESTION BANK FILTERS */
.filter-card-modern {
  background: #fff; border-radius: 12px; /* Matched card style */
  box-shadow: 0 2px 10px #0f3d6b12; /* Softer shadow */
  padding: 15px 20px; margin-bottom: 20px;
  max-width: 100%; /* Full width within review-container */
}
.filter-row { display: flex; gap: 15px; margin-bottom: 12px; flex-wrap: wrap; }
.filter-col {
  flex: 1 1 150px; /* Allow more space */
  min-width: 120px; display: flex; flex-direction: column; gap: 4px;
}
.filter-col label { font-size: 0.9em; color: #185496; font-weight: 600; }
.filter-col select {
  padding: 9px 12px; font-size: 0.95em; border-radius: 6px; /* Matched input style */
  border: 1.2px solid #bcd6ef; background: #f7fafd;
  transition: border-color .18s;
}
.filter-col select:focus { border-color: #1762a7; outline: none; }

/* QUESTION BANK OUTPUT CARD (qb-card) */
.qb-card {
    background-color: #ffffff;
    border: 1px solid #e0e6eb;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.qb-card .q-meta { /* Specific styling for meta in QB if different */
    color: #555; /* Subtler color for QB meta if desired */
    font-weight: bold;
    font-size: 0.9em;
    margin-bottom: 8px;
    border-bottom: 1px dashed #eee;
    padding-bottom: 5px;
}
.qb-card .q-body {
    color: #333; /* Standard text color */
    font-size: 1em;
    line-height: 1.5;
}


/* CUSTOM DROPDOWN (used in AI Setup Form) */
.custom-dropdown {
  position: relative; width: 100%;
  font-size: 1em; /* Matched input font size */
  background: #f7fafd; border-radius: 6px;
  border: 1.3px solid #bcd6ef; cursor: pointer;
  min-height: 42px; /* Based on padding + line height */
  box-sizing: border-box;
}
.selected-option {
  padding: 10px 12px; color: #12416c; font-weight: 500;
  border-radius: 6px; background: transparent; /* Handled by parent */
  user-select: none;
  display: flex; align-items: center; min-height: inherit; /* Ensure it fills */
}
.custom-dropdown.open .selected-option {
  background: #eaf1fa; border-radius: 6px 6px 0 0;
}
.dropdown-options {
  display: none; position: absolute; top: 100%;
  left: -1px; right: -1px; /* Align with border */
  background: #fff; border: 1.3px solid #bcd6ef;
  border-top: none; border-radius: 0 0 6px 6px;
  box-shadow: 0 6px 15px #0f3d6b1a; /* Softer shadow */
  z-index: 100; max-height: 200px; overflow-y: auto;
  animation: fadeInDrop 0.15s ease-out;
}
@keyframes fadeInDrop {
  from { opacity: 0; transform: translateY(-5px); }
  to { opacity: 1; transform: translateY(0); }
}
.dropdown-options div[data-value] { /* Target only option divs */
  padding: 10px 15px; color: #12416c; cursor: pointer;
  font-size: 0.95em; background: #fff;
  border-bottom: 1px solid #e8eef5;
  transition: background 0.1s;
}
.dropdown-options div[data-value]:last-child { border-bottom: none; }
.dropdown-options div[data-value]:hover,
.dropdown-options div[data-value].selected-dd-option { /* Class for selected state */
  background: #e0eaff; color: #0f3d6b; font-weight: 500;
}


/* === AI CHAT INTERFACE STYLES (NEW from Phase 3.1) === */
.ai-chat-header {
  padding: 12px 18px; /* Adjusted padding */
  background-color: #f0f2f5; /* Lighter, neutral background */
  border-bottom: 1px solid #d1d9e0;
  margin-bottom: 12px;
  position: relative; /* For Save All button positioning */
  border-radius: 8px 8px 0 0; /* If ai-review-container has radius */
}
.ai-chat-header h3 {
  margin-top: 0;
  margin-bottom: 6px;
  font-size: 1.15em; /* Slightly larger */
  color: #0f3d6b;
}
.ai-chat-header p {
  font-size: 0.88em; /* Slightly larger */
  color: #4a5c71; /* Softer color */
  margin-bottom: 0;
}
#ai-save-all-chat-btn {
  background-color: #28a745; color: white; border: none;
  padding: 7px 14px; font-size: 0.9em; border-radius: 5px;
  cursor: pointer; transition: background-color 0.2s;
  /* position: absolute; top: 15px; right: 15px; */ /* Now handled in HTML structure if needed */
}
#ai-save-all-chat-btn:hover { background-color: #218838; }
#ai-back-to-setup-btn {
    background-color: #6c757d; color: white; border: none;
    padding: 7px 12px; font-size: 0.85em; border-radius: 5px;
    cursor: pointer; transition: background-color 0.2s;
    /* margin-right: 10px; /* Spacing from title if on same line */
}
#ai-back-to-setup-btn:hover{ background-color: #5a6268; }

.chat-messages-area {
  /* Adjust height carefully based on viewport and other elements */
  height: calc(100vh - (90px + 60px + 70px + 40px)); /* header + review_padding + chat_header + input_bar */
  min-height: 250px; /* Minimum interaction area */
  max-height: 500px; /* Prevent excessive height on large screens within container */
  overflow-y: auto;
  padding: 10px 15px; /* Consistent padding */
  border: 1px solid #e0e0e0;
  background-color: #ffffff; /* Clean white background */
  margin-bottom: 0; /* Input bar is separate */
}

.message {
  margin-bottom: 12px; padding: 10px 14px; /* Increased padding */
  border-radius: 10px; /* Softer radius */
  word-wrap: break-word; max-width: 85%; /* Max width for bubbles */
  line-height: 1.5;
}
.message pre { /* For user and raw AI messages */
  white-space: pre-wrap; word-wrap: break-word;
  font-family: inherit; margin: 0; font-size: 0.98em;
}

.user-message {
  background-color: #007bff; color: white; /* Brighter blue */
  margin-left: auto; border-radius: 10px 10px 0 10px; /* Chat bubble shape */
}
.ai-message { /* General container for AI responses, including questions */
  background-color: #e9ecef; color: #343a40; /* Light grey, dark text */
  margin-right: auto; border-radius: 10px 10px 10px 0; /* Chat bubble shape */
}
.ai-raw-message pre { /* For general AI text not matching question structure */
  font-family: inherit; white-space: pre-wrap; word-wrap: break-word;
  margin:0; color: #343a40;
}

/* Individual AI Question Item (within .ai-message) */
.ai-question-item {
  border: none; /* No double border if parent .ai-message has one */
  padding: 0; /* Padding handled by parent .ai-message */
  margin-bottom: 0 !important; /* Reset margin */
  background-color: transparent; /* Inherit from .ai-message */
}
.question-meta-ai {
  color: #c82333; /* Stronger Red */
  font-weight: 600; /* Bolder */
  font-size: 0.9em;
  margin-bottom: 6px;
  line-height: 1.4; display: block;
}
.question-text-ai {
  color: #004085; /* Darker, richer Blue */
  font-size: 0.98em;
  line-height: 1.55;
  white-space: pre-wrap; display: block;
}

.system-message {
  background-color: #f8f9fa; color: #6c757d; text-align: center;
  font-size: 0.85em; font-style: italic; padding: 8px 10px; max-width: 100%;
  border-radius: 5px;
}
.error-message {
  background-color: #f8d7da; color: #721c24; text-align: center;
  font-weight: 500; padding: 10px; max-width: 100%;
  border-radius: 5px; border: 1px solid #f5c6cb;
}

.chat-input-bar {
  display: flex; align-items: center;
  padding: 10px 15px; background-color: #f0f2f5; /* Match chat header bg */
  border-top: 1px solid #d1d9e0;
  border-radius: 0 0 8px 8px; /* If ai-review-container has radius */
}
#chat-upload-btn, #chat-send-btn {
  background: none; border: none; font-size: 1.4em; /* Slightly smaller icons */
  color: #0f3d6b; cursor: pointer; padding: 8px; /* Adjusted padding */
  transition: color 0.15s;
}
#chat-upload-btn:hover, #chat-send-btn:hover { color: #1762a7; }
#chat-prompt-input {
  flex-grow: 1; padding: 10px 15px; border-radius: 20px; /* Pill shape */
  border: 1.3px solid #ced4da; font-size: 1em;
  margin: 0 10px; resize: none;
  min-height: 24px; /* Start smaller, grows with content */
  max-height: 120px; overflow-y: auto;
  line-height: 1.45;
}
#chat-prompt-input:focus { outline: none; border-color: #0f3d6b; box-shadow: 0 0 0 2px #0f3d6b33; }

.blinking-text { animation: blinker 1.3s linear infinite; }
@keyframes blinker {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.35; }
}

/* Media Queries (Existing and potentially new ones for chat) */
@media (max-width: 700px) {
  .dashboard-header .school-title { font-size: 1.4em; } /* Adjusted */
  .dashboard-header .subtitle { font-size: 0.9em; padding-left: 30px; padding-right: 30px; }
  .dashboard-header { min-height: 75px; border-bottom-left-radius: 22px; border-bottom-right-radius: 22px; padding-bottom: 12px; }
  .dashboard-main { padding: 15px 10px; }
  .dashboard-card { font-size: 0.95em; padding: 20px 15px; min-height: 100px; }
  .settings-popup .popup-content { padding: 20px; }
  .review-container { margin: 15px 10px; padding: 15px 20px; }
  .filter-row { flex-direction: column; gap: 10px; }
  .message { max-width: 90%; } /* Chat bubbles wider on mobile */
  .chat-messages-area {
    /* Adjust height for mobile, considering smaller viewport and keyboard */
    height: calc(100vh - (75px + 40px + 70px + 60px)); /* header + review_padding_approx + chat_header + input_bar */
  }
  #chat-prompt-input { margin: 0 8px; }
  #chat-upload-btn, #chat-send-btn { padding: 6px; font-size: 1.3em; }
}
@media (max-width: 480px) {
    .login-box { padding: 0; border-radius: 12px; }
    .login-header { padding: 20px 15px 15px 15px; border-radius: 12px 12px 0 0; }
    .login-title { font-size: 1.3em; }
    .login-subtitle { font-size: 0.9em; }
    .login-box form, .login-box > input, .login-box > .forgot-row, .login-box > button {
        margin-left: 20px; margin-right: 20px;
    }
     .login-box > input:first-of-type { margin-top: 20px; }
     .login-box > button:last-child { margin-bottom: 20px; }

    .settings-btn { font-size: 1.1em; padding: 7px 9px; right: 10px; }
    .dashboard-header .school-title { font-size: 1.2em; }
    .dashboard-header .subtitle { font-size: 0.8em; }

    .ai-chat-header h3 { font-size: 1.05em;}
    .ai-chat-header p { font-size: 0.8em;}
    #ai-save-all-chat-btn, #ai-back-to-setup-btn { font-size: 0.8em; padding: 5px 8px; }

    .chat-messages-area {
        /* Further fine-tune height for very small screens */
         height: calc(100vh - (75px + 30px + 60px + 55px));
    }
}
/* ... (all your existing CSS rules from before) ... */

/* === AI CHAT INTERFACE STYLES (Existing from Phase 3.1) === */
.ai-chat-header { /* ... */ }
.ai-chat-header h3 { /* ... */ }
.ai-chat-header p { /* ... */ }
#ai-save-all-chat-btn { /* ... */ }
#ai-back-to-setup-btn { /* ... */ }
.chat-messages-area { /* ... */ }
.message { /* ... */ }
.message pre { /* ... */ }
.user-message { /* ... */ }
.ai-message { /* ... */ }
.ai-raw-message pre { /* ... */ }
.ai-question-item { /* ... */ }
.question-meta-ai { /* ... */ }
.question-text-ai { /* ... */ }
.system-message { /* ... */ }
.error-message { /* ... */ }
.chat-input-bar { /* ... */ }
#chat-upload-btn, #chat-send-btn { /* ... */ }
#chat-prompt-input { /* ... */ }
.blinking-text { /* ... */ }
@keyframes blinker { /* ... */ }


/* === NEW STYLES FOR EDIT/DELETE POPUP (Phase 3.3 - Delete part) === */
.ai-question-popup {
  position: absolute; /* Will be positioned by JS */
  background-color: white;
  border: 1px solid #ccc;
  border-radius: 6px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.15);
  padding: 8px;
  z-index: 1010; /* Ensure it's above chat messages */
  display: flex;
  flex-direction: column; /* Stack buttons vertically for now */
  gap: 5px;
}

.ai-question-popup button {
  background-color: #f8f9fa;
  border: 1px solid #ced4da;
  color: #333;
  padding: 6px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9em;
  text-align: left;
  transition: background-color 0.15s;
}

.ai-question-popup button:hover {
  background-color: #e9ecef;
}

.ai-question-popup .popup-delete-btn {
  color: #dc3545; /* Red for delete */
}
.ai-question-popup .popup-delete-btn:hover {
  background-color: #f8d7da; /* Light red hover */
}

.ai-question-popup .popup-edit-btn { /* Style for edit button if added */
  color: #007bff;
}
.ai-question-popup .popup-edit-btn:hover {
  background-color: #e7f3ff;
}


/* Media Queries (Existing) */
@media (max-width: 700px) { /* ... */ }
@media (max-width: 480px) { /* ... */ }

/* ... (all your existing CSS rules from before) ... */

/* === AI CHAT INTERFACE STYLES (Existing and some updates) === */
/* ... (ai-chat-header, .message, .user-message, .ai-message etc. as before) ... */

.ai-question-item {
  /* ... existing styles ... */
  position: relative; /* For positioning edit controls if needed directly */
  padding-bottom: 5px; /* Add some padding if controls are inside */
}

.ai-question-item.editing-question .question-meta-ai,
.ai-question-item.editing-question .question-text-ai {
  background-color: #f0f8ff; /* AliceBlue for editable fields */
  outline: 1px dashed #007bff; /* Blue dashed outline */
  padding: 5px; /* Add some padding when editable */
  margin: 2px 0; /* Adjust margin */
}

.question-meta-ai[contenteditable="true"],
.question-text-ai[contenteditable="true"] {
  /* Additional specific styles if needed while editable */
  cursor: text;
}


/* Styles for Edit/Save/Cancel controls for a question */
.q-edit-controls {
  display: flex;
  gap: 10px;
  justify-content: flex-end; /* Align to the right */
  padding-top: 8px;
  margin-top: 5px;
  border-top: 1px solid #eee; /* Separator */
}

.q-edit-controls .btn-small { /* Re-use existing .btn-small or define new */
  padding: 5px 10px;
  font-size: 0.85em;
  border-radius: 4px;
  cursor: pointer;
  border: 1px solid transparent;
}

.btn-save-edit {
  background-color: #28a745; /* Green */
  color: white;
  border-color: #28a745;
}
.btn-save-edit:hover {
  background-color: #218838;
}

.btn-cancel-edit {
  background-color: #6c757d; /* Grey */
  color: white;
  border-color: #6c757d;
}
.btn-cancel-edit:hover {
  background-color: #5a6268;
}


/* === EDIT/DELETE POPUP STYLES (Existing, ensure they are sufficient) === */
.ai-question-popup {
  position: absolute; 
  background-color: white;
  border: 1px solid #ccc;
  border-radius: 6px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.15);
  padding: 8px;
  z-index: 1010; 
  display: flex;
  flex-direction: column; 
  gap: 5px;
  min-width: 80px; /* Ensure it's not too narrow */
}

.ai-question-popup button {
  background-color: #f8f9fa;
  border: 1px solid #ced4da;
  color: #333;
  padding: 6px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9em;
  text-align: left;
  transition: background-color 0.15s;
  width: 100%; /* Make buttons take full width of popup */
  box-sizing: border-box;
}
.ai-question-popup button:hover {
  background-color: #e9ecef;
}
.ai-question-popup .popup-delete-btn { color: #dc3545; }
.ai-question-popup .popup-delete-btn:hover { background-color: #f8d7da; }
.ai-question-popup .popup-edit-btn { color: #007bff; }
.ai-question-popup .popup-edit-btn:hover { background-color: #e7f3ff; }

/* ... (Rest of your existing CSS including Media Queries) ... */

 QUESTION BANK FILTERS - Custom Dropdowns are styled by existing .custom-dropdown rules */

/* Style for the standard select multiple in Question Bank if needed */
.qb-standard-select-multiple {
  width: 100%;
  padding: 8px 10px; /* Adjust padding to match custom dropdowns' inner feel */
  border-radius: 6px;
  border: 1.3px solid #bcd6ef;
  background-color: #f7fafd; /* Match background */
  font-size: 1em; /* Match font size */
  min-height: 80px; /* Give it some default height */
  box-sizing: border-box;
}
.qb-standard-select-multiple:focus {
  border-color: #1762a7;
  box-shadow: 0 1px 8px #0f3d6b18;
  outline: none;
}

/* Styles for Question Bank Items */
.qb-item {
    /* Uses .question-card base, can add specific overrides */
    margin-bottom: 15px;
}
.qb-item-details { /* For class/subject/chapter info below question */
    color: #555;
    display: block;
    margin-top: 8px;
    font-size: 0.85em;
    border-top: 1px dotted #eee;
    padding-top: 5px;
}
.qb-item-details strong {
    color: #333;
}

/* Meta and Body for QB items will use .question-meta-ai and .question-text-ai for Red/Blue styling */

/* Add if not already covered or if specific QB edit style is needed */
.qb-item.editing-question-qb .question-meta-ai,
.qb-item.editing-question-qb .question-text-ai {
  background-color: #f0f8ff; /* AliceBlue or similar for editable fields */
  outline: 1px dashed #007bff; /* Blue dashed outline */
  padding: 5px; 
  margin: 2px 0; 
  cursor: text;
}

.qb-edit-controls { /* This class is now used */
  display: flex;
  gap: 10px;
  justify-content: flex-end; 
  padding-top: 8px;
  margin-top: 5px;
  border-top: 1px solid #eee; 
}

/* ... (all your existing CSS rules) ... */

/* === EXAM BUILDER FORM STYLES (NEW) === */
#exam-builder-form .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Responsive columns */
    gap: 20px; /* Gap between grid items */
    margin-bottom: 20px;
}

#exam-builder-form .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px; /* Space between label and input/dropdown */
}

#exam-builder-form .form-group-span-2 {
    grid-column: span 2; /* Make an element span two columns */
}

#exam-builder-form label {
    font-weight: 600;
    color: #185496;
    font-size: 0.95em;
    margin-bottom: 0; /* Already have gap in form-group */
}

#exam-builder-form input[type="text"],
#exam-builder-form input[type="date"],
#exam-builder-form input[type="number"],
#exam-builder-form textarea,
#exam-builder-form .custom-dropdown, /* Apply to custom dropdown container */
#exam-builder-form .qb-standard-select-multiple { /* And standard selects if used */
    width: 100%;
    padding: 10px 12px; /* Ensure padding is consistent */
    border-radius: 6px;
    border: 1.3px solid #bcd6ef;
    font-size: 1em;
    background: #f7fafd;
    box-sizing: border-box;
}
#exam-builder-form .custom-dropdown { padding: 0; } /* Reset padding for custom dropdown wrapper */
#exam-builder-form .custom-dropdown .selected-option { padding: 10px 12px; }


#exam-builder-form textarea {
    min-height: 70px;
    resize: vertical;
}

#exam-builder-form input:focus,
#exam-builder-form textarea:focus,
#exam-builder-form select:focus {
    border-color: #1762a7;
    box-shadow: 0 1px 8px #0f3d6b18;
    outline: none;
}

.difficulty-mix-inputs {
    display: flex;
    gap: 10px;
    align-items: center;
}
.difficulty-mix-inputs > div {
    display: flex;
    flex-direction: column; /* Stack label above input */
    flex: 1; /* Distribute space */
}
.difficulty-mix-inputs label {
    font-size: 0.85em;
    margin-bottom: 2px;
}
.difficulty-mix-inputs input[type="number"] {
    width: 100%; /* Make inputs fill their flex item space */
    padding: 8px; /* Slightly smaller padding for these */
}

.sections-container {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e0e6eb;
}
.sections-container h3 {
    margin-top: 0;
    margin-bottom: 15px;
    color: #0f3d6b;
}

/* Ensure .btn-small is defined if used */
.btn-small {
    padding: 6px 12px;
    font-size: 0.9em;
    border-radius: 4px;
    cursor: pointer;
    /* Add other base button styles like border, background, color if not inherited */
}
#eb-add-section-btn i {
    margin-right: 5px;
}


/* Media query for smaller screens if form grid needs adjustment */
@media (max-width: 600px) {
    #exam-builder-form .form-grid {
        grid-template-columns: 1fr; /* Stack to single column */
    }
    #exam-builder-form .form-group-span-2 {
        grid-column: span 1; /* Reset span for single column */
    }
    .difficulty-mix-inputs {
        flex-direction: column; /* Stack percentage inputs vertically */
        align-items: stretch;
    }
}
/* ... (all your existing CSS rules) ... */

/* === EXAM BUILDER FORM STYLES (Existing and additions) === */
/* ... (styles for .form-grid, .form-group etc. as before) ... */

.sections-container {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #e0e6eb;
}
.sections-container h3 {
    margin-top: 0;
    margin-bottom: 15px;
    color: #0f3d6b;
}

#eb-sections-list {
    display: flex;
    flex-direction: column;
    gap: 20px; /* Space between section items */
}

.exam-section-item {
    border: 1px solid #d1d9e0;
    border-radius: 8px;
    padding: 15px;
    background-color: #f8f9fa; /* Light background for each section block */
}

.exam-section-item h4 {
    margin-top: 0;
    margin-bottom: 15px;
    color: #1762a7;
    border-bottom: 1px solid #e0e6eb;
    padding-bottom: 10px;
    display: flex; /* For aligning title input with "Section X:" text */
    align-items: center;
}
.eb-section-title-input {
    flex-grow: 1;
    margin-left: 10px;
    font-size: 0.9em; /* Match h4 a bit better */
    padding: 6px 8px;
    border: 1px solid #ced4da;
    border-radius: 4px;
}


.exam-section-item .form-grid.section-grid { /* Specific grid for inputs within a section */
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Adjust column size for sections */
    gap: 15px;
    padding-bottom: 10px; /* Space before potential next section */
}

.exam-section-item .form-group {
    margin-bottom: 5px; /* Less margin within section groups */
}
.exam-section-item label {
    font-size: 0.9em; /* Slightly smaller labels within sections */
}

.btn-remove-section {
    background-color: #f44336; /* Red */
    color: white;
    border: none;
    padding: 8px 12px; /* Make it a bit more prominent */
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85em;
    display: inline-flex; /* Align icon and text */
    align-items: center;
    margin-top: 10px; /* Align with other inputs if they are in a row */
}
.btn-remove-section i {
    margin-right: 5px;
}
.btn-remove-section:hover {
    background-color: #d32f2f;
}

#eb-add-section-btn i {
    margin-right: 5px;
}
/* === TOAST POPUP STYLES === */
.toast-popup {
  visibility: hidden;
  min-width: 250px;
  max-width: 90%;
  background-color: #333;
  color: #fff;
  text-align: center;
  border-radius: 5px;
  padding: 16px;
  position: fixed;
  z-index: 10000; /* Above everything */
  left: 50%;
  bottom: 30px; /* Default to bottom */
  transform: translateX(-50%);
  font-size: 1em;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  transition: visibility 0s 0.5s, opacity 0.5s linear; /* Delay hiding */
  opacity: 0;
}

.toast-popup.show {
  visibility: visible;
  opacity: 1;
  transition: opacity 0.5s linear; /* Fade in */
}

/* Different types of toasts */
.toast-popup.success {
  background-color: #28a745; /* Green */
}

.toast-popup.error {
  background-color: #dc3545; /* Red */
}

.toast-popup.info {
  background-color: #17a2b8; /* Teal/Blue */
}

/* For top position (optional, use by adding a class or modifying JS) */
/*
.toast-popup.top {
  bottom: auto;
  top: 30px;
}
*/
/* === CUSTOM MULTI-SELECT DROPDOWN STYLES === */
.custom-multiselect-dropdown .dropdown-options div[data-value] {
  display: flex; /* Align checkbox and text */
  align-items: center;
}

.custom-multiselect-dropdown .option-checkbox {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 1.5px solid #adb5bd;
  border-radius: 3px;
  margin-right: 10px;
  background-color: #fff;
  transition: background-color 0.1s, border-color 0.1s;
  flex-shrink: 0; /* Prevent shrinking */
}

.custom-multiselect-dropdown .dropdown-options div[data-value].selected-dd-option .option-checkbox,
.custom-multiselect-dropdown .option-checkbox.checked { /* Add .checked class via JS */
  background-color: #007bff; /* Or your theme's primary color */
  border-color: #007bff;
  position: relative; /* For the checkmark */
}

/* Optional: Add a checkmark using pseudo-element */
.custom-multiselect-dropdown .option-checkbox.checked::after {
  content: "";
  position: absolute;
  left: 5px;
  top: 2px;
  width: 4px;
  height: 8px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Ensure the main display of the dropdown for multi-select is not overly tall */
.custom-multiselect-dropdown .selected-option {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* (End of your style.css file) */
/* === EXAM BUILDER - SECTION DRAG & DROP STYLES === */
.exam-section-item[draggable="true"] {
  cursor: grab; /* Indicate draggable item */
}

.exam-section-item.is-dragging {
  opacity: 0.6;
  border: 2px dashed #007bff; /* Highlight color during drag */
  background-color: #eef5ff; /* Slightly different background when dragging */
}

/* Optional: Style for when an item is being dragged over another (target) */
/* You might not need this if you re-render immediately on drop,
   or if you use a more complex placeholder strategy during dragover */
.exam-section-item.drag-over-target-top {
    border-top: 3px solid #4dabf7; /* Example: show line where it will drop */
}
.exam-section-item.drag-over-target-bottom {
    border-bottom: 3px solid #4dabf7;
}
